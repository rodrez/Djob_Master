{% extends '_base.html' %}
{% load pages_filters %}
{% load static %}
{% load humanize %}
{% block content %}
{% load widget_tweaks %}
<link rel="stylesheet" href="//cdn.quilljs.com/1.3.6/quill.bubble.css">

    <main class="flex-grow">
        <section class="relative">
            <div class="absolute inset-0 h-128 pt-16 box-content">
                <div class="h-full w-full"></div>
            </div>
        </section>

        {% include 'djob_profile/profile_components/display_profile.html' %}

        <div class="relative max-w-6xl mx-auto px-4 sm:px-6">
            <div class="pb-12 md:pb-20">
                <div class="max-w-3xl mx-auto">

                    {% comment %} Education Start {% endcomment %}

                    {% include 'djob_profile/profile_components/display_edu.html' %}

                    {% comment %} Education Ends {% endcomment %}

                    {% comment %} Start Experiences {% endcomment %}

                    <section class='mt-10'>

                        <div class="max-w-4xl px-8 py-4 mx-auto bg-white rounded shadow-lg dark:bg-gray-800">

                            <div class="lg:w-full">

                                <div class="flex mb-4 items-center">
                                    <h2 class="text-3xl font-bold text-gray-800 dark:text-gray-100" id="EXP">
                                        Experiences</h2>
                                    <button class="hidden flex-no-shrink p-2 ml-4 mr-2">
                                        <svg
                                                class="h-10 w-10"
                                                id="color" enable-background="new 0 0 24 24" height="512"
                                                viewBox="0 0 24 24" width="512"
                                                xmlns="http://www.w3.org/2000/svg">
                                            <path d="m15.854 23.146c-1.313-1.313-1.353-2.586-1.354-2.649-.002-.275-.225-.497-.5-.497h-4.02c-.276 0-.5.227-.5.503 0 .054-.018 1.328-1.333 2.644-.143.143-.186.358-.108.545.076.186.259.308.461.308h7c.202 0 .385-.122.462-.309s.034-.401-.108-.545z"
                                                  fill="#90a4ae"/>
                                            <path d="m14.25 4c-.414 0-.75-.336-.75-.75v-1.5c0-.138-.112-.25-.25-.25h-2.5c-.138 0-.25.112-.25.25v1.5c0 .414-.336.75-.75.75s-.75-.336-.75-.75v-1.5c0-.965.785-1.75 1.75-1.75h2.5c.965 0 1.75.785 1.75 1.75v1.5c0 .414-.336.75-.75.75z"
                                                  fill="#64b5f6"/>
                                            <path d="m16.25 10.5h-8.5c-.965 0-1.75-.785-1.75-1.75v-4.5c0-.965.785-1.75 1.75-1.75h8.5c.965 0 1.75.785 1.75 1.75v4.5c0 .965-.785 1.75-1.75 1.75z"
                                                  fill="#2196f3"/>
                                            <path d="m18 7h-12v-1.5h12z" fill="#64b5f6"/>
                                            <path d="m12 8c-.414 0-.75-.336-.75-.75v-2c0-.414.336-.75.75-.75s.75.336.75.75v2c0 .414-.336.75-.75.75z"
                                                  fill="#64b5f6"/>
                                            <path d="m24 5.75v13.5c0 .96-.79 1.75-1.75 1.75h-20.5c-.96 0-1.75-.79-1.75-1.75v-13.5c0-.96.79-1.75 1.75-1.75h2.78l-.03.25v1.75h-2.5v11h20v-11h-2.5v-1.75l-.03-.25h2.78c.96 0 1.75.79 1.75 1.75z"
                                                  fill="#607d8b"/>
                                            <path d="m22 6v11h-20v-11h2.5v2.75c0 1.79 1.46 3.25 3.25 3.25h8.5c1.79 0 3.25-1.46 3.25-3.25v-2.75z"
                                                  fill="#f5f5f5"/>
                                            <path d="m12 21h-2.591c-.118.501-.431 1.315-1.262 2.146-.143.143-.186.358-.108.545.076.187.259.309.461.309h3.5z"
                                                  fill="#7d8f97"/>
                                            <path d="m12 0h-1.25c-.965 0-1.75.785-1.75 1.75v.75h1.5v-.75c0-.138.112-.25.25-.25h1.25z"
                                                  fill="#579ed6"/>
                                            <path d="m12 2.5h-1.5-1.5-1.25c-.965 0-1.75.785-1.75 1.75v4.5c0 .965.785 1.75 1.75 1.75h4.25v-2.5c-.414 0-.75-.336-.75-.75v-.25h-5.25v-1.5h5.25v-.25c0-.414.336-.75.75-.75z"
                                                  fill="#1d83d4"/>
                                            <path d="m11.25 5.5h-5.25v1.5h5.25z" fill="#579ed6"/>
                                            <path d="m12 4.5c-.414 0-.75.336-.75.75v.25 1.5.25c0 .414.336.75.75.75z" fill="#579ed6"/>
                                            <path d="m4.53 4h-2.78c-.96 0-1.75.79-1.75 1.75v13.5c0 .96.79 1.75 1.75 1.75h7.659 2.591v-4h-10v-11h2.5v-1.75z"
                                                  fill="#546d79"/>
                                            <path d="m4.5 6h-2.5v11h10v-5h-4.25c-1.79 0-3.25-1.46-3.25-3.25z" fill="#d5d5d5"/>
                                        </svg>
                                    </button>

                                </div>
                            <div >
                                    <form method="POST">

                                    {% csrf_token %}
                                            {% for foo in form %}
                                                <div id="form_set">
                                                {{ form.management_form }}
                                                {% for f in foo %}
                                                    {% if f.name == "DELETE" %}
                                                        <p class="text-red-600 font-semibold">{{ f.label }}</p>
                                                        {{ f|add_class:'flex-1 appearance-none border border-transparent mb-4 bg-white text-gray-700 placeholder-gray-400 shadow-md rounded text-base focus:outline-none mt-3 focus:ring-violet-600 focus:border-transparent'}}
                                                    {% elif f.name == 'id'%}
                                                        {{ f|add_class:'hidden' }}
                                                    {% elif f.name == 'user'%}
                                                        {{ f|add_class:'opacity-0' }}
                                                    {% elif f.name == "job_description" %}
                                                        <p>{{ f.label }}</p><br>
                                                       <div id="editor" class="job-summ w-full rounded shadow-lg dark:text-white border border-gray-200 dark:bg-gray-600 dark:text-white dark:bg-opacity-25 dark:border-gray-700">
                                                        </div>
                                                        {{ f|add_class:'model-field hidden w-full border py-2 border-gray-200 rounded hover:border-gray-300 shadow dark:text-white dark:bg-gray-600 dark:text-white dark:bg-opacity-25 dark:border-gray-700 focus:outline-none focus:border-violet-600 transition-colors' }}
                                                    {% else %}
                                                        <p>{{ f.label }}</p>
                                                        {{ f|add_class:'w-full border py-2 border-gray-200 rounded hover:border-gray-300 shadow dark:text-white dark:bg-gray-600 dark:text-white dark:bg-opacity-25 dark:border-gray-700 focus:outline-none focus:border-violet-600 transition-colors' }}
                                                    {% endif %}
                                                    <br>
                                                {% endfor %}
                                                <style>
                                                    #id_form-{{ forloop.counter0 }}-job_description {
                                                            width: 100%;
                                                            word-wrap: break-word;
                                                        }
                                                </style>
                                                <hr class="mt-4 mb-4"></div>
                                            {% endfor %}

                                        <button class="cursor-pointer font-semibold text-white text-center py-2 rounded mt-4 bg-violet-500 w-full" type="submit" value="Update">
                                            Update
                                        </button>
                                    </form>
                            </div>
                                <button class="font-semibold cursor-pointer bg-transparent text-white text-center py-2 rounded mt-4 bg-lightBlue-400 w-full " id="add_more_exp" type="submit" value="Add Experience">
                                    Add Experience
                                </button>
                        </div>
                        <div id="empty_form" style="display:none">
                            <table class='no_error'>
                                {% for f in form.empty_form %}
                                        {% if f.name == "DELETE" %}
                                            <p class="text-red-600 font-semibold">{{ f.label }}</p>
                                            {{ f|add_class:'flex-1 appearance-none border border-transparent mb-4 bg-white text-gray-700 placeholder-gray-400 shadow-md rounded text-base focus:outline-none mt-3 focus:ring-violet-600 focus:border-transparent'}}
                                        {% elif f.name == 'id'%}
                                            {{ f|add_class:'hidden' }}
                                        {% elif f.name == 'user'%}
                                            {{ f|add_class:'' }}
                                        {% elif f.name == "job_description" %}

                                            <p>{{ f.label }}</p>
                                            <div id="editor" class="job-summ w-full p-3 rounded shadow-lg dark:text-white border border-gray-200 dark:bg-gray-600 dark:text-white dark:bg-opacity-25 dark:border-gray-700">
                                            </div>
                                            {{ f|add_class:'model-field hidden w-full border py-2 border-gray-200 rounded hover:border-gray-300 shadow dark:text-white dark:bg-gray-600 dark:text-white dark:bg-opacity-25 dark:border-gray-700 focus:outline-none focus:border-violet-600 transition-colors' }}
                                        {% else %}
                                            <p>{{ f.label }}</p>
                                            {{ f|add_class:'style-field w-full rounded shadow-lg dark:text-white border border-gray-200 dark:bg-gray-600 dark:text-white dark:bg-opacity-25 dark:border-gray-700'}}
                                        {% endif %}
                                        <br>
                                    {% endfor %}
                            </table>
                        </div>
                        </div>
                    </section>
                </div>
            </div>
        </div>
    </main>


<script src="https://code.jquery.com/jquery-3.6.0.min.js"
          integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4="
          crossorigin="anonymous"></script>

    <script>

    let job_elements = document.getElementsByClassName('job-summ')
    let prev_summary = document.getElementsByClassName('model-field')

    for (let i=0; i<job_elements.length; i++){
        job_elements[i].textContent = prev_summary[i].value
    }

    job_summary[3].addEventListener('blur', function() {
        element = document.getElementById("id_benefits")
        element.value = job_summary[3].innerHTML
     })
    </script>

        <script>
            {% comment %} AutoFills User based on request.user {% endcomment %}
        // All the select elements
        function assignUser(){
            let selects = document.getElementsByTagName('select');

            // Initializing z
            let idx = 0;

            // For loop to get all select options

                for (idx; idx < selects.length; idx++){
                {#console.log(selects[z].value)#}

                // Assigns the options
                selects[idx].selectedIndex = {{ request.user.id }}
            }
        }
        {% comment %} AutoFills User based on request.user {% endcomment %}

            $('#add_more_exp').click(function() {
            let form_idx = $('#id_form-TOTAL_FORMS').val();
            $('#form_set').append($('#empty_form').html().replace(/__prefix__/g, form_idx));
            $('#id_form-TOTAL_FORMS').val(parseInt(form_idx) + 1);
            assignUser();
        });
            function clearForm(e_id){
                let elements = document.getElementById(e_id).elements;

                for (let i = 0; i < elements.length; i++) {
                    console.log(elements[i].value);
                    }
                }
    {#let editors = document.getElementsByClassName("django-ckeditor-widget");#}
    {#        console.log(editors)#}
    {#        for (let i=0; i < editors.length; i++){#}
    {#            editors[i].classList.add("w-full");#}
    {#        }#}
    {#let#}
    </script>


{#    <script type="text/javascript" src="{% static "ckeditor/ckeditor-init.js" %}"></script>#}
{#    <script type="text/javascript" src="{% static "ckeditor/ckeditor/ckeditor.js" %}"></script>#}
<script src="//cdn.quilljs.com/1.3.6/quill.js"></script>
<script>
let toolbarOptions = [
  ['bold', 'italic', 'underline'],        // toggled buttons
  ['blockquote', 'code-block'],

  [{ 'header': 1 }, { 'header': 2 }, { 'header': 3 }],               // custom button values
  [{ 'list': 'ordered'}, { 'list': 'bullet' }],
  [{ 'script': 'sub'}, { 'script': 'super' }],      // superscript/subscript
  [{ 'indent': '-1'}, { 'indent': '+1' }],          // outdent/indent

  [{ 'size': ['small', false, 'large', 'huge'] }],  // custom dropdown
  [{ 'header': [1, 2, 3, 4, 5, 6, false] }],

  ['clean']                                         // remove formatting button
];

let quill1 = new Quill('#editor', {
  theme: 'bubble',
    modules: {
    toolbar: toolbarOptions
  },// Specify theme in configuration
});
let quill2 = new Quill('#editor2', {
  theme: 'bubble',
    modules: {
    toolbar: toolbarOptions
  },// Specify theme in configuration
});
let quill3 = new Quill('#editor3', {
  theme: 'bubble',
    modules: {
    toolbar: toolbarOptions
  },// Specify theme in configuration
});
let quill4 = new Quill('#editor4', {
  theme: 'bubble',
    modules: {
    toolbar: toolbarOptions
  },// Specify theme in configuration
});
</script>
    <script>

    const job_summary = document.querySelectorAll(".ql-editor")
    job_summary[0].classList.add("text-base")
    job_summary[1].classList.add("text-base")
    job_summary[2].classList.add("text-base")
    job_summary[3].classList.add("text-base")

    job_summary[0].classList.add("font-iter")
    job_summary[1].classList.add("font-iter")
    job_summary[2].classList.add("font-iter")
    job_summary[3].classList.add("font-iter")



    job_summary[0].addEventListener('blur', function() {
        element = document.getElementById("id_job_summary")
        element.value = job_summary[0].innerHTML
    })

    job_summary[1].addEventListener('blur', function() {
        element = document.getElementById("id_minimum_requirements")
        element.value = job_summary[1].innerHTML
     })

    job_summary[2].addEventListener('blur', function() {
        element = document.getElementById("id_preferred_requirements")
        element.value = job_summary[2].innerHTML
     })

    job_summary[3].addEventListener('blur', function() {
        element = document.getElementById("id_benefits")
        element.value = job_summary[3].innerHTML
     })

    </script>

{% endblock content %}